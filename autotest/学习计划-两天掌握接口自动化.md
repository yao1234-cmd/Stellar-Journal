# æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ - ä¸¤å¤©å­¦ä¹ è®¡åˆ’

## ğŸ“‹ å­¦ä¹ ç›®æ ‡
- **ç¬¬1å¤©**ï¼šç†è§£æ¡†æ¶æ¶æ„å’Œæ ¸å¿ƒç»„ä»¶
- **ç¬¬2å¤©**ï¼šåŠ¨æ‰‹ç¼–å†™ä¸€æ¡å®Œæ•´çš„æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹

---

## ğŸ“… ç¬¬ä¸€å¤©ï¼šæ¡†æ¶ç†è§£ä¸æ ¸å¿ƒç»„ä»¶å­¦ä¹ 

### ä¸Šåˆï¼ˆ3-4å°æ—¶ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸ç¯å¢ƒæ­å»º

#### 1.1 äº†è§£é¡¹ç›®ç»“æ„ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æŸ¥çœ‹ `autotest/` ç›®å½•ç»“æ„
- ç†è§£å„ç›®å½•çš„ä½œç”¨ï¼š
  - `tests/` - æµ‹è¯•ç”¨ä¾‹ç›®å½•
  - `utils/` - å·¥å…·ç±»ç›®å½•
  - `config/` - é…ç½®æ–‡ä»¶ç›®å½•
  - `reports/` - æµ‹è¯•æŠ¥å‘Šç›®å½•
  - `logs/` - æ—¥å¿—ç›®å½•

**å®è·µä»»åŠ¡ï¼š**
```bash
# æŸ¥çœ‹é¡¹ç›®ç»“æ„
cd D:\web-healthcare-platform-master\autotest
tree /F  # Windowsä¸‹æŸ¥çœ‹ç›®å½•æ ‘
```

#### 1.2 ç¯å¢ƒå‡†å¤‡ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æ£€æŸ¥Pythonç‰ˆæœ¬ï¼ˆéœ€è¦3.12+ï¼‰
- å®‰è£…ä¾èµ–åŒ…
- ç†è§£ `requirements.txt` ä¸­å„åŒ…çš„ä½œç”¨

**å®è·µä»»åŠ¡ï¼š**
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python --version

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
pip install -r requirements.txt

# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
pip list
```

**å…³é”®ä¾èµ–è¯´æ˜ï¼š**
- `pytest` - æµ‹è¯•æ¡†æ¶ï¼Œç”¨äºç¼–å†™å’Œæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
- `requests` - HTTPè¯·æ±‚åº“ï¼Œç”¨äºå‘é€APIè¯·æ±‚
- `allure-pytest` - ç”Ÿæˆç¾è§‚çš„æµ‹è¯•æŠ¥å‘Š
- `pydantic` - æ•°æ®éªŒè¯
- `PyYAML` - è¯»å–YAMLé…ç½®æ–‡ä»¶
- `faker` - ç”Ÿæˆå‡æ•°æ®ç”¨äºæµ‹è¯•

#### 1.3 é…ç½®æ–‡ä»¶ç†è§£ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `config/config.yaml` æ–‡ä»¶
- ç†è§£é…ç½®é¡¹çš„ä½œç”¨ï¼š
  - `test_env.base_url` - APIåŸºç¡€åœ°å€
  - `test_env.timeout` - è¯·æ±‚è¶…æ—¶æ—¶é—´
  - `test_data` - é¢„å®šä¹‰çš„æµ‹è¯•æ•°æ®

**å®è·µä»»åŠ¡ï¼š**
- æ‰“å¼€ `config/config.yaml`ï¼Œç†è§£æ¯ä¸ªé…ç½®é¡¹
- å°è¯•ä¿®æ”¹ `base_url` çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ

#### 1.4 è¿è¡Œä¸€ä¸ªç°æœ‰æµ‹è¯•ç”¨ä¾‹ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- ç†è§£å¦‚ä½•æ‰§è¡Œæµ‹è¯•
- æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š

**å®è·µä»»åŠ¡ï¼š**
```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
pytest tests/test_doctor_api.py -v

# è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹
pytest tests/test_doctor_api.py::TestDoctorAPI::test_get_doctors_success -v

# æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Š
# å¦‚æœå®‰è£…äº†allure
allure serve ./reports/allure-results
```

---

### ä¸‹åˆï¼ˆ3-4å°æ—¶ï¼‰ï¼šæ ¸å¿ƒå·¥å…·ç±»æ·±å…¥å­¦ä¹ 

#### 2.1 HTTPClient å·¥å…·ç±»ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `utils/http_client.py`
- ç†è§£ä»¥ä¸‹æ ¸å¿ƒæ¦‚å¿µï¼š
  - **Sessionä¼šè¯**ï¼šä¸ºä»€ä¹ˆä½¿ç”¨Sessionè€Œä¸æ˜¯ç›´æ¥requests
  - **é‡è¯•æœºåˆ¶**ï¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¯·æ±‚
  - **æ—¥å¿—è®°å½•**ï¼šè‡ªåŠ¨è®°å½•è¯·æ±‚å’Œå“åº”
  - **Allureé›†æˆ**ï¼šè‡ªåŠ¨é™„åŠ è¯·æ±‚ä¿¡æ¯åˆ°æŠ¥å‘Š

**å…³é”®ä»£ç ç†è§£ï¼š**
```python
# HTTPClientçš„æ ¸å¿ƒæ–¹æ³•
http_client.get(endpoint, params={})      # GETè¯·æ±‚
http_client.post(endpoint, json_data={})  # POSTè¯·æ±‚
http_client.put(endpoint, json_data={})   # PUTè¯·æ±‚
http_client.delete(endpoint)              # DELETEè¯·æ±‚
```

**å®è·µä»»åŠ¡ï¼š**
1. æ‰“å¼€ `utils/http_client.py`ï¼Œé€è¡Œé˜…è¯»ä»£ç 
2. ç†è§£ `__init__` æ–¹æ³•åšäº†ä»€ä¹ˆ
3. ç†è§£ `request` æ–¹æ³•çš„æ‰§è¡Œæµç¨‹
4. å°è¯•åœ¨Pythonäº¤äº’ç¯å¢ƒä¸­ä½¿ç”¨HTTPClientï¼š
```python
from utils.http_client import HTTPClient
client = HTTPClient()
response = client.get("/api/doctors")
print(response.status_code)
print(response.json())
```

#### 2.2 AssertionHelper æ–­è¨€åŠ©æ‰‹ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `utils/assertion_helper.py`
- ç†è§£å¸¸ç”¨çš„æ–­è¨€æ–¹æ³•ï¼š
  - `assert_status_code()` - æ–­è¨€HTTPçŠ¶æ€ç 
  - `assert_json_structure()` - æ–­è¨€JSONç»“æ„
  - `assert_json_value()` - æ–­è¨€JSONå€¼
  - `assert_response_time()` - æ–­è¨€å“åº”æ—¶é—´

**å®è·µä»»åŠ¡ï¼š**
1. ç†è§£æ¯ä¸ªæ–­è¨€æ–¹æ³•çš„ä½œç”¨
2. å°è¯•ä½¿ç”¨æ–­è¨€åŠ©æ‰‹ï¼š
```python
from utils.assertion_helper import assert_helper
from utils.http_client import HTTPClient

client = HTTPClient()
response = client.get("/api/doctors")

# ä½¿ç”¨æ–­è¨€åŠ©æ‰‹
assert_helper.assert_status_code(response, 200)
assert_helper.assert_json_structure(response, ['code', 'data'])
assert_helper.assert_json_value(response, 'code', 0)
```

#### 2.3 ConfigManager é…ç½®ç®¡ç†ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `utils/config_manager.py`
- ç†è§£å¦‚ä½•è¯»å–é…ç½®æ–‡ä»¶
- ç†è§£é…ç½®çš„åµŒå¥—è®¿é—®ï¼ˆå¦‚ `test_env.base_url`ï¼‰

**å®è·µä»»åŠ¡ï¼š**
```python
from utils.config_manager import config

# è·å–é…ç½®
base_url = config.get_base_url()
timeout = config.get_timeout()
test_data = config.get_test_data('valid_medicine')

print(f"åŸºç¡€URL: {base_url}")
print(f"è¶…æ—¶æ—¶é—´: {timeout}")
print(f"æµ‹è¯•æ•°æ®: {test_data}")
```

#### 2.4 DataGenerator æ•°æ®ç”Ÿæˆå™¨ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `utils/data_generator.py`
- ç†è§£å¦‚ä½•ç”Ÿæˆæµ‹è¯•æ•°æ®
- ç†è§£Fakeråº“çš„ä½¿ç”¨

**å®è·µä»»åŠ¡ï¼š**
```python
from utils.data_generator import data_generator

# ç”Ÿæˆå„ç§æµ‹è¯•æ•°æ®
medicine_data = data_generator.generate_medicine_data()
patient_data = data_generator.generate_patient_data()
doctor_data = data_generator.generate_doctor_data()

print("ç”Ÿæˆçš„è¯ç‰©æ•°æ®:", medicine_data)
print("ç”Ÿæˆçš„æ‚£è€…æ•°æ®:", patient_data)
print("ç”Ÿæˆçš„åŒ»ç”Ÿæ•°æ®:", doctor_data)
```

#### 2.5 conftest.py ç†è§£ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- é˜…è¯» `tests/conftest.py`
- ç†è§£pytestçš„fixtureæœºåˆ¶
- ç†è§£ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›fixture

**å…³é”®æ¦‚å¿µï¼š**
- `@pytest.fixture` - pytestçš„å¤¹å…·è£…é¥°å™¨
- `scope="session"` - æ•´ä¸ªæµ‹è¯•ä¼šè¯åªæ‰§è¡Œä¸€æ¬¡
- `scope="function"` - æ¯ä¸ªæµ‹è¯•å‡½æ•°æ‰§è¡Œä¸€æ¬¡
- `autouse=True` - è‡ªåŠ¨ä½¿ç”¨ï¼Œæ— éœ€åœ¨æµ‹è¯•å‡½æ•°ä¸­å£°æ˜

**å®è·µä»»åŠ¡ï¼š**
- ç†è§£ `http_client` fixtureçš„ä½œç”¨
- ç†è§£ `test_data` fixtureçš„ä½œç”¨
- ç†è§£ä¸ºä»€ä¹ˆæµ‹è¯•å‡½æ•°å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›fixtureä½œä¸ºå‚æ•°

---

### æ™šä¸Šï¼ˆ1-2å°æ—¶ï¼‰ï¼šæµ‹è¯•ç”¨ä¾‹ç»“æ„åˆ†æ

#### 3.1 åˆ†æä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æ·±å…¥é˜…è¯» `tests/test_doctor_api.py`
- ç†è§£æµ‹è¯•ç”¨ä¾‹çš„å®Œæ•´ç»“æ„ï¼š
  - Allureè£…é¥°å™¨çš„ä½œç”¨
  - pytestæ ‡è®°ï¼ˆmarkï¼‰çš„ä½œç”¨
  - æµ‹è¯•å‡½æ•°çš„ç¼–å†™æ¨¡å¼

**æµ‹è¯•ç”¨ä¾‹ç»“æ„æ¨¡æ¿ï¼š**
```python
@allure.epic("äº‘åŒ»ç–—ç³»ç»Ÿ")           # å²è¯—ï¼ˆå¤§æ¨¡å—ï¼‰
@allure.feature("åŒ»ç”Ÿç®¡ç†")          # åŠŸèƒ½æ¨¡å—
class TestDoctorAPI:                 # æµ‹è¯•ç±»
    @allure.story("è·å–åŒ»ç”Ÿåˆ—è¡¨")     # ç”¨æˆ·æ•…äº‹
    @allure.title("è·å–åŒ»ç”Ÿåˆ—è¡¨ - æ­£å¸¸åœºæ™¯")  # æµ‹è¯•æ ‡é¢˜
    @allure.severity(allure.severity_level.CRITICAL)  # ä¸¥é‡ç¨‹åº¦
    @pytest.mark.smoke               # pytestæ ‡è®°
    @pytest.mark.positive           # æ­£å‘æµ‹è¯•
    def test_get_doctors_success(self, http_client: HTTPClient):
        """æµ‹è¯•è·å–åŒ»ç”Ÿåˆ—è¡¨çš„æ­£å¸¸åŠŸèƒ½"""
        with allure.step("å‘é€è·å–åŒ»ç”Ÿåˆ—è¡¨è¯·æ±‚"):
            response = http_client.get("/api/doctors")
        
        with allure.step("éªŒè¯å“åº”"):
            assert_helper.assert_status_code(response, 200)
            assert_helper.assert_json_structure(response, ['code', 'data'])
            assert_helper.assert_json_value(response, 'code', 0)
```

**å®è·µä»»åŠ¡ï¼š**
1. é€‰æ‹©ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹ï¼Œé€è¡Œåˆ†æ
2. ç†è§£æ¯ä¸ªè£…é¥°å™¨çš„ä½œç”¨
3. ç†è§£æµ‹è¯•æ­¥éª¤çš„åˆ’åˆ†ï¼ˆä½¿ç”¨ `allure.step`ï¼‰

#### 3.2 pytestæ ‡è®°ç†è§£ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æŸ¥çœ‹ `pytest.ini` ä¸­çš„æ ‡è®°å®šä¹‰
- ç†è§£æ ‡è®°çš„ä½œç”¨ï¼š
  - `@pytest.mark.smoke` - å†’çƒŸæµ‹è¯•
  - `@pytest.mark.positive` - æ­£å‘æµ‹è¯•
  - `@pytest.mark.negative` - è´Ÿå‘æµ‹è¯•
  - `@pytest.mark.parametrize` - å‚æ•°åŒ–æµ‹è¯•

**å®è·µä»»åŠ¡ï¼š**
```bash
# åªè¿è¡Œå†’çƒŸæµ‹è¯•
pytest -m smoke

# åªè¿è¡Œæ­£å‘æµ‹è¯•
pytest -m positive

# è¿è¡Œå‚æ•°åŒ–æµ‹è¯•ç¤ºä¾‹
pytest tests/test_doctor_api.py::TestDoctorAPI::test_get_doctors_by_department -v
```

---

## ğŸ“… ç¬¬äºŒå¤©ï¼šåŠ¨æ‰‹ç¼–å†™å®Œæ•´æµ‹è¯•ç”¨ä¾‹

### ä¸Šåˆï¼ˆ3-4å°æ—¶ï¼‰ï¼šé€‰æ‹©ä¸€ä¸ªæ¥å£ï¼Œåˆ†æéœ€æ±‚

#### 4.1 é€‰æ‹©ç›®æ ‡æ¥å£ï¼ˆ30åˆ†é’Ÿï¼‰
**å»ºè®®é€‰æ‹©ï¼š**
- é€‰æ‹©ä¸€ä¸ªç®€å•çš„GETæ¥å£å¼€å§‹ï¼ˆå¦‚è·å–åˆ—è¡¨ï¼‰
- æˆ–è€…é€‰æ‹©ä¸€ä¸ªç®€å•çš„POSTæ¥å£ï¼ˆå¦‚åˆ›å»ºèµ„æºï¼‰

**å¯é€‰æ¥å£ï¼š**
1. **GET /api/medicines** - è·å–è¯ç‰©åˆ—è¡¨ï¼ˆæœ€ç®€å•ï¼‰
2. **GET /api/medicines/{id}** - è·å–è¯ç‰©è¯¦æƒ…
3. **POST /api/medicines** - åˆ›å»ºè¯ç‰©ï¼ˆéœ€è¦æ•°æ®å‡†å¤‡ï¼‰

**å®è·µä»»åŠ¡ï¼š**
- æŸ¥çœ‹é¡¹ç›®APIæ–‡æ¡£æˆ–ç°æœ‰æµ‹è¯•ç”¨ä¾‹
- é€‰æ‹©ä¸€ä¸ªä½ æ„Ÿå…´è¶£çš„æ¥å£
- ç†è§£è¿™ä¸ªæ¥å£çš„ï¼š
  - è¯·æ±‚æ–¹æ³•ï¼ˆGET/POST/PUT/DELETEï¼‰
  - è¯·æ±‚è·¯å¾„
  - è¯·æ±‚å‚æ•°
  - å“åº”æ ¼å¼

#### 4.2 åˆ†ææ¥å£éœ€æ±‚ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- ç†è§£æ¥å£çš„ä¸šåŠ¡é€»è¾‘
- ç¡®å®šæµ‹è¯•åœºæ™¯ï¼š
  - **æ­£å‘æµ‹è¯•**ï¼šæ­£å¸¸æƒ…å†µä¸‹çš„æµ‹è¯•
  - **è´Ÿå‘æµ‹è¯•**ï¼šå¼‚å¸¸æƒ…å†µä¸‹çš„æµ‹è¯•
  - **è¾¹ç•Œæµ‹è¯•**ï¼šè¾¹ç•Œå€¼çš„æµ‹è¯•

**å®è·µä»»åŠ¡ï¼š**
ä»¥ `GET /api/medicines` ä¸ºä¾‹ï¼Œåˆ†ææµ‹è¯•åœºæ™¯ï¼š

1. **æ­£å‘æµ‹è¯•åœºæ™¯ï¼š**
   - æ­£å¸¸è·å–è¯ç‰©åˆ—è¡¨
   - å¸¦å…³é”®è¯ç­›é€‰
   - å¸¦åˆ†ç±»ç­›é€‰
   - åˆ†é¡µæŸ¥è¯¢

2. **è´Ÿå‘æµ‹è¯•åœºæ™¯ï¼š**
   - æ— æ•ˆçš„å…³é”®è¯
   - æ— æ•ˆçš„åˆ†ç±»
   - æ— æ•ˆçš„åˆ†é¡µå‚æ•°

3. **è¾¹ç•Œæµ‹è¯•åœºæ™¯ï¼š**
   - ç©ºåˆ—è¡¨
   - è¶…å¤§åˆ†é¡µå‚æ•°

#### 4.3 è®¾è®¡æµ‹è¯•æ•°æ®ï¼ˆ30åˆ†é’Ÿï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- ç¡®å®šéœ€è¦å“ªäº›æµ‹è¯•æ•°æ®
- ä½¿ç”¨DataGeneratorç”Ÿæˆæ•°æ®
- æˆ–è€…ä½¿ç”¨config.yamlä¸­çš„é¢„å®šä¹‰æ•°æ®

**å®è·µä»»åŠ¡ï¼š**
```python
# å¦‚æœéœ€è¦åˆ›å»ºæ•°æ®ï¼Œä½¿ç”¨DataGenerator
from utils.data_generator import data_generator

# ç”Ÿæˆæµ‹è¯•æ•°æ®
test_medicine = data_generator.generate_medicine_data(
    name="æµ‹è¯•è¯ç‰©",
    price=10.50,
    stock=100
)
```

#### 4.4 æŸ¥çœ‹ç°æœ‰ç±»ä¼¼æµ‹è¯•ç”¨ä¾‹ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æ‰¾åˆ°ç±»ä¼¼çš„æµ‹è¯•ç”¨ä¾‹ä½œä¸ºå‚è€ƒ
- ç†è§£æµ‹è¯•ç”¨ä¾‹çš„ç¼–å†™æ¨¡å¼
- å­¦ä¹ æœ€ä½³å®è·µ

**å®è·µä»»åŠ¡ï¼š**
- æ‰“å¼€ `tests/test_medicine_api.py` æˆ– `tests/test_doctor_api.py`
- æ‰¾ä¸€ä¸ªç±»ä¼¼çš„æµ‹è¯•ç”¨ä¾‹
- ç†è§£å®ƒçš„ç¼–å†™æ–¹å¼
- å‡†å¤‡æ¨¡ä»¿ç¼–å†™

---

### ä¸‹åˆï¼ˆ3-4å°æ—¶ï¼‰ï¼šç¼–å†™å®Œæ•´æµ‹è¯•ç”¨ä¾‹

#### 5.1 åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼ˆ30åˆ†é’Ÿï¼‰
**å®è·µä»»åŠ¡ï¼š**
1. åœ¨ `tests/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æµ‹è¯•æ–‡ä»¶ï¼ˆå¦‚æœæµ‹è¯•æ–°æ¥å£ï¼‰
   - æˆ–è€…é€‰æ‹©ç°æœ‰æ–‡ä»¶æ·»åŠ æµ‹è¯•ç”¨ä¾‹
2. ç¼–å†™æµ‹è¯•ç±»çš„åŸºæœ¬ç»“æ„

**ç¤ºä¾‹ï¼š**
```python
# -*- coding: utf-8 -*-
"""
è¯ç‰©ç®¡ç†APIæµ‹è¯•ç”¨ä¾‹ - æ–°å¢æµ‹è¯•
"""

import pytest
import allure
from utils.http_client import HTTPClient
from utils.assertion_helper import assert_helper


@allure.epic("äº‘åŒ»ç–—ç³»ç»Ÿ")
@allure.feature("è¯ç‰©ç®¡ç†")
class TestMedicineAPINew:
    """è¯ç‰©ç®¡ç†APIæµ‹è¯•ç±» - æ–°å¢ç”¨ä¾‹"""
    
    # åœ¨è¿™é‡Œæ·»åŠ æµ‹è¯•æ–¹æ³•
    pass
```

#### 5.2 ç¼–å†™ç¬¬ä¸€ä¸ªæ­£å‘æµ‹è¯•ç”¨ä¾‹ï¼ˆ1.5å°æ—¶ï¼‰
**å®è·µä»»åŠ¡ï¼š**
ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„æ­£å‘æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…å«ï¼š

1. **Allureè£…é¥°å™¨**ï¼š
   - `@allure.story()` - ç”¨æˆ·æ•…äº‹
   - `@allure.title()` - æµ‹è¯•æ ‡é¢˜
   - `@allure.severity()` - ä¸¥é‡ç¨‹åº¦

2. **pytestæ ‡è®°**ï¼š
   - `@pytest.mark.smoke` - å¦‚æœæ˜¯å†’çƒŸæµ‹è¯•
   - `@pytest.mark.positive` - æ­£å‘æµ‹è¯•

3. **æµ‹è¯•æ­¥éª¤**ï¼š
   - ä½¿ç”¨ `allure.step()` åˆ’åˆ†æ­¥éª¤
   - å‘é€è¯·æ±‚
   - éªŒè¯å“åº”

**å®Œæ•´ç¤ºä¾‹ï¼š**
```python
@allure.story("è·å–è¯ç‰©åˆ—è¡¨")
@allure.title("è·å–è¯ç‰©åˆ—è¡¨ - æ­£å¸¸åœºæ™¯")
@allure.severity(allure.severity_level.CRITICAL)
@pytest.mark.smoke
@pytest.mark.positive
def test_get_medicines_success(self, http_client: HTTPClient):
    """æµ‹è¯•è·å–è¯ç‰©åˆ—è¡¨çš„æ­£å¸¸åŠŸèƒ½"""
    with allure.step("æ­¥éª¤1: å‘é€è·å–è¯ç‰©åˆ—è¡¨è¯·æ±‚"):
        response = http_client.get("/api/medicines")
    
    with allure.step("æ­¥éª¤2: éªŒè¯HTTPçŠ¶æ€ç "):
        assert_helper.assert_status_code(response, 200)
    
    with allure.step("æ­¥éª¤3: éªŒè¯å“åº”æ—¶é—´"):
        assert_helper.assert_response_time(response, 5.0)
    
    with allure.step("æ­¥éª¤4: éªŒè¯å“åº”JSONç»“æ„"):
        assert_helper.assert_json_structure(response, ['code', 'data', 'total'])
    
    with allure.step("æ­¥éª¤5: éªŒè¯ä¸šåŠ¡çŠ¶æ€ç "):
        assert_helper.assert_json_value(response, 'code', 0)
    
    with allure.step("æ­¥éª¤6: éªŒè¯æ•°æ®ä¸ä¸ºç©ºï¼ˆå¦‚æœæœ‰æ•°æ®ï¼‰"):
        json_data = response.json()
        if json_data.get('total', 0) > 0:
            assert len(json_data['data']) > 0, "è¯ç‰©åˆ—è¡¨ä¸åº”ä¸ºç©º"
```

**å®è·µæ­¥éª¤ï¼š**
1. æŒ‰ç…§ç¤ºä¾‹ç¼–å†™ä½ çš„æµ‹è¯•ç”¨ä¾‹
2. è¿è¡Œæµ‹è¯•ï¼š`pytest tests/ä½ çš„æµ‹è¯•æ–‡ä»¶.py::ä½ çš„æµ‹è¯•ç±»::ä½ çš„æµ‹è¯•æ–¹æ³• -v`
3. æŸ¥çœ‹æµ‹è¯•ç»“æœ
4. å¦‚æœå¤±è´¥ï¼Œåˆ†æé”™è¯¯å¹¶ä¿®å¤

#### 5.3 ç¼–å†™å‚æ•°åŒ–æµ‹è¯•ç”¨ä¾‹ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- ä½¿ç”¨ `@pytest.mark.parametrize` è¿›è¡Œå‚æ•°åŒ–
- ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æµ‹è¯•å¤šä¸ªåœºæ™¯

**å®è·µä»»åŠ¡ï¼š**
```python
@allure.story("è·å–è¯ç‰©åˆ—è¡¨")
@allure.title("æŒ‰åˆ†ç±»ç­›é€‰è¯ç‰©")
@pytest.mark.parametrize("category", ["æŠ—ç”Ÿç´ ", "æ„Ÿå†’è¯", "æ­¢ç—›è¯", "æ¶ˆç‚è¯"])
def test_get_medicines_by_category(self, http_client: HTTPClient, category):
    """æµ‹è¯•æŒ‰åˆ†ç±»ç­›é€‰è¯ç‰©"""
    with allure.step(f"å‘é€æŒ‰åˆ†ç±»'{category}'ç­›é€‰çš„è¯·æ±‚"):
        response = http_client.get("/api/medicines", params={"category": category})
    
    with allure.step("éªŒè¯å“åº”"):
        assert_helper.assert_status_code(response, 200)
        assert_helper.assert_json_structure(response, ['code', 'data'])
        assert_helper.assert_json_value(response, 'code', 0)
```

#### 5.4 ç¼–å†™è´Ÿå‘æµ‹è¯•ç”¨ä¾‹ï¼ˆ1å°æ—¶ï¼‰
**å­¦ä¹ å†…å®¹ï¼š**
- æµ‹è¯•å¼‚å¸¸åœºæ™¯
- éªŒè¯é”™è¯¯å¤„ç†

**å®è·µä»»åŠ¡ï¼š**
```python
@allure.story("è·å–è¯ç‰©è¯¦æƒ…")
@allure.title("è·å–ä¸å­˜åœ¨çš„è¯ç‰©è¯¦æƒ…")
@pytest.mark.negative
def test_get_medicine_detail_not_found(self, http_client: HTTPClient):
    """æµ‹è¯•è·å–ä¸å­˜åœ¨çš„è¯ç‰©è¯¦æƒ…"""
    non_existent_id = 99999
    
    with allure.step(f"å‘é€è·å–ä¸å­˜åœ¨è¯ç‰©è¯¦æƒ…è¯·æ±‚ (ID: {non_existent_id})"):
        response = http_client.get(f"/api/medicines/{non_existent_id}")
    
    with allure.step("éªŒè¯è¿”å›404çŠ¶æ€ç "):
        assert_helper.assert_status_code(response, 404)
    
    with allure.step("éªŒè¯é”™è¯¯ä¿¡æ¯ç»“æ„"):
        assert_helper.assert_json_structure(response, ['detail'])
```

---

### æ™šä¸Šï¼ˆ1-2å°æ—¶ï¼‰ï¼šå®Œå–„ä¸æ€»ç»“

#### 6.1 è¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹æŠ¥å‘Šï¼ˆ30åˆ†é’Ÿï¼‰
**å®è·µä»»åŠ¡ï¼š**
```bash
# è¿è¡Œä½ çš„æµ‹è¯•ç”¨ä¾‹
pytest tests/ä½ çš„æµ‹è¯•æ–‡ä»¶.py -v

# ç”ŸæˆAllureæŠ¥å‘Š
allure serve ./reports/allure-results

# æŸ¥çœ‹HTMLæŠ¥å‘Š
# æ‰“å¼€ ./reports/report.html
```

**æ£€æŸ¥ç‚¹ï¼š**
- æµ‹è¯•æ˜¯å¦é€šè¿‡
- AllureæŠ¥å‘Šä¸­æ˜¯å¦æ˜¾ç¤ºäº†æµ‹è¯•æ­¥éª¤
- è¯·æ±‚å’Œå“åº”ä¿¡æ¯æ˜¯å¦æ­£ç¡®è®°å½•

#### 6.2 ä»£ç ä¼˜åŒ–ï¼ˆ30åˆ†é’Ÿï¼‰
**ä¼˜åŒ–æ–¹å‘ï¼š**
1. **æ·»åŠ æ›´å¤šæ–­è¨€**ï¼šç¡®ä¿æµ‹è¯•å……åˆ†
2. **ä¼˜åŒ–æµ‹è¯•æ­¥éª¤**ï¼šä½¿æ­¥éª¤æ›´æ¸…æ™°
3. **æ·»åŠ æ³¨é‡Š**ï¼šè§£é‡Šå¤æ‚çš„é€»è¾‘
4. **é”™è¯¯å¤„ç†**ï¼šå¤„ç†å¯èƒ½çš„å¼‚å¸¸æƒ…å†µ

#### 6.3 æ€»ç»“ä¸å¤ä¹ ï¼ˆ30åˆ†é’Ÿï¼‰
**æ€»ç»“è¦ç‚¹ï¼š**
1. **æ¡†æ¶æ¶æ„**ï¼š
   - HTTPClient - å‘é€HTTPè¯·æ±‚
   - AssertionHelper - æ–­è¨€éªŒè¯
   - ConfigManager - é…ç½®ç®¡ç†
   - DataGenerator - æ•°æ®ç”Ÿæˆ

2. **æµ‹è¯•ç”¨ä¾‹ç»“æ„**ï¼š
   - Allureè£…é¥°å™¨
   - pytestæ ‡è®°
   - æµ‹è¯•æ­¥éª¤åˆ’åˆ†
   - æ–­è¨€éªŒè¯

3. **æ‰§è¡Œæµç¨‹**ï¼š
   - ç¼–å†™æµ‹è¯•ç”¨ä¾‹
   - è¿è¡Œpytest
   - æŸ¥çœ‹æŠ¥å‘Š

---

## ğŸ“š å­¦ä¹ èµ„æºä¸å‚è€ƒ

### å¿…è¯»æ–‡ä»¶æ¸…å•
1. âœ… `autotest/automation-readme.md` - é¡¹ç›®è¯´æ˜æ–‡æ¡£
2. âœ… `autotest/utils/http_client.py` - HTTPå®¢æˆ·ç«¯
3. âœ… `autotest/utils/assertion_helper.py` - æ–­è¨€åŠ©æ‰‹
4. âœ… `autotest/utils/config_manager.py` - é…ç½®ç®¡ç†
5. âœ… `autotest/utils/data_generator.py` - æ•°æ®ç”Ÿæˆå™¨
6. âœ… `autotest/tests/conftest.py` - pytesté…ç½®
7. âœ… `autotest/tests/test_doctor_api.py` - å‚è€ƒæµ‹è¯•ç”¨ä¾‹
8. âœ… `autotest/config/config.yaml` - é…ç½®æ–‡ä»¶

### å…³é”®æ¦‚å¿µé€ŸæŸ¥

#### pyteståŸºç¡€
- `@pytest.fixture` - å¤¹å…·ï¼Œç”¨äºå‡†å¤‡æµ‹è¯•æ•°æ®
- `@pytest.mark.parametrize` - å‚æ•°åŒ–æµ‹è¯•
- `@pytest.mark.xxx` - æµ‹è¯•æ ‡è®°
- `pytest -v` - è¯¦ç»†è¾“å‡º
- `pytest -m smoke` - è¿è¡Œæ ‡è®°ä¸ºsmokeçš„æµ‹è¯•

#### AllureæŠ¥å‘Š
- `@allure.epic()` - å²è¯—ï¼ˆå¤§æ¨¡å—ï¼‰
- `@allure.feature()` - åŠŸèƒ½æ¨¡å—
- `@allure.story()` - ç”¨æˆ·æ•…äº‹
- `@allure.title()` - æµ‹è¯•æ ‡é¢˜
- `@allure.step()` - æµ‹è¯•æ­¥éª¤
- `allure.attach()` - é™„åŠ ä¿¡æ¯åˆ°æŠ¥å‘Š

#### HTTPè¯·æ±‚
- `http_client.get(url, params={})` - GETè¯·æ±‚
- `http_client.post(url, json_data={})` - POSTè¯·æ±‚
- `response.status_code` - çŠ¶æ€ç 
- `response.json()` - JSONå“åº”
- `response.elapsed` - å“åº”æ—¶é—´

---

## âœ… å­¦ä¹ æ£€æŸ¥æ¸…å•

### ç¬¬ä¸€å¤©æ£€æŸ¥ç‚¹
- [ ] èƒ½å¤Ÿç†è§£é¡¹ç›®ç›®å½•ç»“æ„
- [ ] èƒ½å¤Ÿè¿è¡Œç°æœ‰çš„æµ‹è¯•ç”¨ä¾‹
- [ ] ç†è§£HTTPClientçš„å·¥ä½œåŸç†
- [ ] ç†è§£AssertionHelperçš„å¸¸ç”¨æ–¹æ³•
- [ ] ç†è§£ConfigManagerå¦‚ä½•è¯»å–é…ç½®
- [ ] ç†è§£DataGeneratorå¦‚ä½•ç”Ÿæˆæ•°æ®
- [ ] ç†è§£pytest fixtureçš„ä½œç”¨
- [ ] èƒ½å¤Ÿåˆ†æä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ç»“æ„

### ç¬¬äºŒå¤©æ£€æŸ¥ç‚¹
- [ ] èƒ½å¤Ÿé€‰æ‹©ä¸€ä¸ªæ¥å£å¹¶åˆ†ææµ‹è¯•éœ€æ±‚
- [ ] èƒ½å¤Ÿè®¾è®¡æµ‹è¯•åœºæ™¯ï¼ˆæ­£å‘ã€è´Ÿå‘ã€è¾¹ç•Œï¼‰
- [ ] èƒ½å¤Ÿç¼–å†™ä¸€ä¸ªå®Œæ•´çš„æ­£å‘æµ‹è¯•ç”¨ä¾‹
- [ ] èƒ½å¤Ÿç¼–å†™å‚æ•°åŒ–æµ‹è¯•ç”¨ä¾‹
- [ ] èƒ½å¤Ÿç¼–å†™è´Ÿå‘æµ‹è¯•ç”¨ä¾‹
- [ ] èƒ½å¤Ÿè¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹æŠ¥å‘Š
- [ ] èƒ½å¤Ÿç†è§£æµ‹è¯•æŠ¥å‘Šçš„å†…å®¹

---

## ğŸ¯ é¢è¯•å‡†å¤‡è¦ç‚¹

### å¯èƒ½è¢«é—®åˆ°çš„é—®é¢˜

1. **æ¡†æ¶æ¶æ„é—®é¢˜ï¼š**
   - "è¿™ä¸ªæ¡†æ¶æœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ"
   - "ä¸ºä»€ä¹ˆä½¿ç”¨Sessionè€Œä¸æ˜¯ç›´æ¥requestsï¼Ÿ"
   - "å¦‚ä½•å®ç°æµ‹è¯•æ•°æ®çš„å¤ç”¨ï¼Ÿ"

2. **æµ‹è¯•è®¾è®¡é—®é¢˜ï¼š**
   - "å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ¥å£çš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿ"
   - "æ­£å‘æµ‹è¯•å’Œè´Ÿå‘æµ‹è¯•çš„åŒºåˆ«ï¼Ÿ"
   - "å¦‚ä½•å®ç°å‚æ•°åŒ–æµ‹è¯•ï¼Ÿ"

3. **å®è·µé—®é¢˜ï¼š**
   - "å¦‚ä½•å®šä½æµ‹è¯•å¤±è´¥çš„åŸå› ï¼Ÿ"
   - "å¦‚ä½•æé«˜æµ‹è¯•ç”¨ä¾‹çš„å¯ç»´æŠ¤æ€§ï¼Ÿ"
   - "å¦‚ä½•é›†æˆåˆ°CI/CDï¼Ÿ"

### å›ç­”è¦ç‚¹
- å¼ºè°ƒæ¡†æ¶çš„åˆ†å±‚è®¾è®¡ï¼ˆå·¥å…·ç±»ã€æµ‹è¯•ç”¨ä¾‹åˆ†ç¦»ï¼‰
- å¼ºè°ƒæµ‹è¯•ç”¨ä¾‹çš„å¯è¯»æ€§ï¼ˆAllureæ­¥éª¤ã€æ¸…æ™°å‘½åï¼‰
- å¼ºè°ƒæµ‹è¯•æ•°æ®çš„çµæ´»æ€§ï¼ˆDataGeneratorã€é…ç½®æ–‡ä»¶ï¼‰
- å¼ºè°ƒæµ‹è¯•æŠ¥å‘Šçš„é‡è¦æ€§ï¼ˆAllureæŠ¥å‘Šã€æ—¥å¿—è®°å½•ï¼‰

---

## ğŸ’¡ å­¦ä¹ å»ºè®®

1. **å¾ªåºæ¸è¿›**ï¼šå…ˆç†è§£æ¡†æ¶ï¼Œå†åŠ¨æ‰‹ç¼–å†™
2. **å¤šå®è·µ**ï¼šæ¯å­¦ä¸€ä¸ªæ¦‚å¿µå°±åŠ¨æ‰‹è¯•è¯•
3. **å¤šå‚è€ƒ**ï¼šå‚è€ƒç°æœ‰çš„æµ‹è¯•ç”¨ä¾‹
4. **å¤šæ€»ç»“**ï¼šæ¯å®Œæˆä¸€ä¸ªé˜¶æ®µå°±æ€»ç»“ä¸€ä¸‹
5. **å¤šæé—®**ï¼šé‡åˆ°é—®é¢˜åŠæ—¶æŸ¥æ‰¾èµ„æ–™æˆ–è¯¢é—®

---

## ğŸ“ å­¦ä¹ è®°å½•æ¨¡æ¿

### ç¬¬ä¸€å¤©å­¦ä¹ è®°å½•
- **é‡åˆ°çš„é—®é¢˜ï¼š**
  - 
- **è§£å†³æ–¹æ¡ˆï¼š**
  - 
- **æ”¶è·ï¼š**
  - 

### ç¬¬äºŒå¤©å­¦ä¹ è®°å½•
- **ç¼–å†™çš„æµ‹è¯•ç”¨ä¾‹ï¼š**
  - 
- **é‡åˆ°çš„é—®é¢˜ï¼š**
  - 
- **è§£å†³æ–¹æ¡ˆï¼š**
  - 
- **æ”¶è·ï¼š**
  - 

---

**ç¥ä½ å­¦ä¹ é¡ºåˆ©ï¼Œé¢è¯•æˆåŠŸï¼** ğŸ‰
